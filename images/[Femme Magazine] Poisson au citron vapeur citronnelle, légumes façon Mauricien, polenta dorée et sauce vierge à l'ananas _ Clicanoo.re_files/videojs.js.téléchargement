if(void 0===adways.resource.playStates.SEEKING)throw new Error('"adways.resource.playStates.SEEKING" is missing.');if(void 0===adways.resource.playStates.PAUSED)throw new Error('"adways.resource.playStates.PAUSED" is missing.');if(void 0===adways.resource.playStates.PLAYING)throw new Error('"adways.resource.playStates.PLAYING" is missing.');if(void 0===adways.resource.events.VOLUME_CHANGED)throw new Error('"adways.resource.events.VOLUME_CHANGED" is missing.');if(void 0===adways.resource.events.CURRENT_TIME_CHANGED)throw new Error('"adways.resource.events.CURRENT_TIME_CHANGED" is missing.');if(void 0===adways.resource.events.MUTED_CHANGED)throw new Error('"adways.resource.events.MUTED_CHANGED" is missing.');if(void 0===adways.resource.events.PLAYBACK_RATE_CHANGED)throw new Error('"adways.resource.events.PLAYBACK_RATE_CHANGED" is missing.');if(void 0===adways.resource.events.FULLSCREEN_CHANGED)throw new Error('"adways.resource.events.FULLSCREEN_CHANGED" is missing.');if(void 0===adways.resource.events.STREAM_SIZE_CHANGED)throw new Error('"adways.resource.events.STREAM_SIZE_CHANGED" is missing.');if(void 0===adways.hv.events.PAUSE_LOCKED_CHANGED)throw new Error('"adways.hv.events.PAUSE_LOCKED_CHANGED" is missing.');if(void 0===adways.hv.events.LAYER_ADDED)throw new Error('"adways.hv.events.LAYER_ADDED" is missing.');if(void 0===adways.hv.events.LAYER_REMOVED)throw new Error('"adways.hv.events.LAYER_REMOVED" is missing.');if(void 0===adways.geom.evaluateContentRect)throw new Error('"adways.geom.evaluateContentRect" is missing.');if(void 0===adways.hv.layerIds.HOTSPOT)throw new Error('"adways.hv.layerIds.HOTSPOT" is missing.');if(void 0===adways.hv.layerIds.POPUP)throw new Error('"adways.hv.layerIds.POPUP" is missing.');if(void 0===adways.hv.layerIds.CONTROLLER)throw new Error('"adways.hv.layerIds.CONTROLLER" is missing.');if(void 0===adways.hv.layerIds.UNDEFINED)throw new Error('"adways.hv.layerIds.UNDEFINED" is missing.');VideoJSDelegate=function(e,t,s,i){this.video=s,this.p2s=e,this.s2p=t,this.zIndexLayers=1,this.playerSizeIncludesControllerSize=!0,this.savePlayState=null,this.videoElement=null,this.isPlayingAd=!1,this.backgroundDiv=null,this.hotspotDiv=null,this.topDiv=null,this.popupDiv=null,this.controllerDiv=null,this.isIOS=adways.misc.html.userAgent.UA.device[0].identifier===adways.misc.html.userAgent.IPHONE&&adways.misc.html.userAgent.UA.os[0].version[1]>=10||adways.misc.html.userAgent.UA.device[0].identifier===adways.misc.html.userAgent.IPAD||!1,this.customFullscreen=null,this.interactiveContainer=document.getElementsByClassName("upvideo__interactive-container"),this.delegateParams=i,void 0===this.delegateParams&&(this.delegateParams=new Object),"object"!=typeof this.delegateParams.fullscreenHelper&&(this.delegateParams.fullscreenHelper=new Object),void 0!==this.delegateParams.fullscreenHelper.containerDOMElement?this.delegateParams.fullscreenHelper.base=this.delegateParams.fullscreenHelper.containerDOMElement:this.delegateParams.fullscreenHelper.base=this.video.el(),void 0!==this.delegateParams.fullscreenHelper.playerDOMElement?this.delegateParams.fullscreenHelper.target=this.delegateParams.fullscreenHelper.playerDOMElement:this.delegateParams.fullscreenHelper.target=this.video.el(),this.videoElement=this.video.el().getElementsByTagName("video").length>0?this.video.el().getElementsByTagName("video")[0]:this.video.el().getElementsByTagName("object")[0],this.streamWidth=Number.NaN,this.streamHeight=Number.NaN,this.renderTransform=new Array(Number.NaN,Number.NaN,Number.NaN,Number.NaN,Number.NaN,Number.NaN),this.renderSize=new Array(Number.NaN,Number.NaN);var r=this;this.p2s.setExtrapolateCurrentTime(!0),this.videoDurationListener=function(){r.p2s.setDuration(r.video.duration())},this.videoDurationListener(),this.videoPlaybackRateListener=function(){r.p2s.setPlaybackRate(r.video.playbackRate())},this.videoPlaybackRateListener(),this.videoTimeUpdateListener=function(){r.isPlayingAd?r.p2s.setCurrentTime(0):r.p2s.setCurrentTime(r.video.currentTime())},this.videoTimeUpdateListener(),this.videoPlayStateListener=function(){r.isPlayingAd||(r.isIOS&&(r.video.controlBar.fullscreenToggle.el().style.display="block"),r.video.paused()?r.p2s.pause():r.p2s.play())},this.videoPlayStateListener(),this.isSeeking=!1,this.videoSeekingListener=function(){r.isSeeking||(r.isSeeking=!0,r.savePlayState=r.video.paused(),r.p2s.pause())},this.videoSeekedListener=function(){r.isSeeking=!1,r.savePlayState?r.p2s.pause():r.p2s.play(),r.savePlayState||r.p2s.play()},this.videoEndedListener=function(){r.video.ended()&&r.p2s.end()},this.videoEndedListener(),this.videoVolumeListener=function(){r.video.muted()?r.p2s.mute():r.p2s.unmute(),r.p2s.setVolume(r.video.volume())},this.videoVolumeListener(),this.videoLoadedMetaDataListener=function(e){"object"==typeof r.videoElement&&(r.streamWidth=e.target.videoWidth,r.streamHeight=e.target.videoHeight,r.updateStreamRect())},"object"==typeof this.videoElement&&(this.streamWidth=this.videoElement.videoWidth,this.streamHeight=this.videoElement.videoHeight,this.updateStreamRect());this.videoErrorListener=function(){r.p2s.dispatchError(403,"The media resource specified by src was not usable.")},null!=this.video.error()&&this.videoErrorListener(),this.adImpressionListener=function(e){r.isPlayingAd=!0,r.p2s.getAdPlayState().set(adways.resource.playStates.PLAYING),r.p2s.setExtrapolateCurrentTime(!1),r.p2s.pause(),r.backgroundDiv&&(r.backgroundDiv.style.display="none"),r.hotspotDiv&&(r.hotspotDiv.style.display="none"),r.controllerDiv&&(r.controllerDiv.style.display="none"),r.popupDiv&&(r.popupDiv.style.display="none")},this.adCompleteListener=function(e){r.backgroundDiv&&(r.backgroundDiv.style.display="block"),r.hotspotDiv&&(r.hotspotDiv.style.display="block"),r.controllerDiv&&(r.controllerDiv.style.display="block"),r.popupDiv&&(r.popupDiv.style.display="block"),r.p2s.setExtrapolateCurrentTime(!0),r.isPlayingAd=!1,r.p2s.getAdPlayState().set(adways.resource.playStates.PAUSED),r.videoPlayStateListener()},this.sizeWatcherListener=function(){var e=r.video.el();if(e){var t=e.getElementsByClassName("vjs-ad-container"),s=r.video.el().ownerDocument.getElementById("af_player_1_ima-ad-container");if(t.length>0&&"none"!==t[0].style.display){var i=t[0];if(i.children.length>0&&i.children)for(var n=i.children[0],a=0;a<n.children.length;a++)"none"!==getComputedStyle(n.children[a],null).getPropertyValue("display")&&"0"!==getComputedStyle(n.children[a],null).getPropertyValue("opacity")&&r.adImpressionListener()}else s&&"none"!==s.style.display?r.adImpressionListener():setTimeout(r.adCompleteListener,1e3);var o=e.offsetWidth,l=e.offsetHeight;if(r.playerSizeIncludesControllerSize&&!r.video.isFullscreen()){var d=r.video.controlBar.el(),h=r.evaluateControlBarPosition();2==h?o+=d.offsetLeft-e.offsetWidth+d.offsetWidth:3==h?l+=d.offsetTop-e.offsetHeight+d.offsetHeight:4==h?o-=d.offsetLeft:1==h&&(l-=d.offsetTop)}var v=r.updateRenderRect();(v+=r.p2s.setPlayerSize(new Array(o,l)))>0&&r.updateStreamRect()}},this.sizeWatcherListener(),this.videoFullscreenListener=function(e){if(r.playerSizeIncludesControllerSize){var t=r.evaluateControlBarPosition();if(1==t||4==t){var s=r.s2p.layersToArray();if(r.video.isFullscreen())for(var i=0;i<s.length;++i){(n=s[i].getDomElement()).style.top="0px",n.style.left="0px"}else for(i=0;i<s.length;++i){var n=s[i].getDomElement(),a=r.video.el().offsetTop,o=r.video.el().offsetLeft,l=r.video.controlBar.el();4==t&&(o+=l.offsetLeft),1==t&&(a+=l.offsetTop),n.style.top=a+"px",n.style.left=o+"px"}}}r.sizeWatcherListener(),r.isIOS||(r.video.isFullscreen()?r.p2s.enterFullscreen():r.p2s.exitFullscreen())},this.videoFullscreenListener(),this.p2s.setCanChangeVolume(!0),this.p2s.setCanChangeFullscreen(!0),this.p2s.setCanChangePlaybackRate(!0),this.p2s.setCanChangePlayState(!0),this.p2s.setCanChangeCurrentTime(!0),this.p2s.setCanTransformRenderer(!0),this.isIOS&&(this.fullscreenCB=function(e){return e.stopPropagation(),e.preventDefault(),adways.fullscreenManager.isFullscreen()?adways.fullscreenManager.exitFullscreen():r.customFullscreen.enterFullscreen(),!1},this.fullscreenExitedCB=function(){r.p2s.exitFullscreen()},this.fullscreenEnteredCB=function(){r.p2s.enterFullscreen()},adways.fullscreenManager.addEventListener(adways.misc.html.fullscreen.events.ENTERED,this.fullscreenEnteredCB,this),adways.fullscreenManager.addEventListener(adways.misc.html.fullscreen.events.EXITED,this.fullscreenExitedCB,this),this.customFullscreen=new adways.misc.html.fullscreen.Helper(this.video.el()),this.nativeControls="function"==typeof this.video.usingNativeControls?this.video.usingNativeControls():"function"==typeof this.video.useNativeControls?this.video.useNativeControls():null,this.nativeControls?(this.fullscreenButton=this.video.el().ownerDocument.createElement("div"),this.fullscreenButton.style.width="55px",this.fullscreenButton.style.height="40px",this.fullscreenButton.style.position="absolute",this.fullscreenButton.style.top="0px",this.fullscreenButton.style.left="0px",this.fullscreenButton.id="customFullscreenButton",this.fullscreenButton.style.zIndex="1",this.video.el().appendChild(this.fullscreenButton)):(this.fullscreenButton=this.video.el().ownerDocument.createElement("div"),this.fullscreenButton.style.width="100%",this.fullscreenButton.style.height="100%",this.fullscreenButton.style.position="absolute",this.fullscreenButton.style.top="0",this.fullscreenButton.style.left="0",this.fullscreenButton.id="customFullscreenButton",this.fullscreenButton.style.zIndex="1",this.video.controlBar.fullscreenToggle.el().appendChild(this.fullscreenButton)),adways.misc.html.addEventListener(this.fullscreenButton,"touchstart",this.fullscreenCB,!0)),this.video.on("fullscreenchange",this.videoFullscreenListener),this.video.on("durationchange",this.videoDurationListener),this.video.on("timeupdate",this.videoTimeUpdateListener),this.video.on("play",this.videoPlayStateListener),this.video.on("pause",this.videoPlayStateListener),this.video.on("ended",this.videoEndedListener),this.video.on("seeking",this.videoSeekingListener),this.video.on("seeked",this.videoSeekedListener),this.video.on("volumechange",this.videoVolumeListener),this.video.on("error",this.videoErrorListener),this.sizeWatcherTimer=setInterval(this.sizeWatcherListener,250),this.video.on("fullscreenchange",this.videoFullscreenListener),this.video.on("loadedmetadata",this.videoLoadedMetaDataListener),this.s2p.addEventListener(adways.resource.events.PLAY_STATE_CHANGED,this.s2pPlayStateChangedListener,this),this.s2p.addEventListener(adways.resource.events.VOLUME_CHANGED,this.s2pVolumeChangedListener,this),this.s2p.addEventListener(adways.resource.events.MUTED_CHANGED,this.s2pMutedChangedListener,this),this.s2p.addEventListener(adways.resource.events.CURRENT_TIME_CHANGED,this.s2pCurrentTimeChangedListener,this),this.s2p.addEventListener(adways.resource.events.PLAYBACK_RATE_CHANGED,this.s2pPlaybackRateChangedListener,this),this.s2p.addEventListener(adways.resource.events.FULLSCREEN_CHANGED,this.s2pFullscreenChangedListener,this),this.s2p.addEventListener(adways.hv.events.LAYER_ADDED,this.s2pLayerAddedListener,this),this.s2p.addEventListener(adways.hv.events.LAYER_REMOVED,this.s2pLayerRemovedListener,this),this.s2p.addEventListener(adways.resource.events.STREAM_SIZE_CHANGED,this.s2pStreamSizeChangedListener,this),this.s2p.addEventListener(adways.resource.events.RENDER_SIZE_CHANGED,this.s2pRenderSizeChangedListener,this),this.s2p.addEventListener(adways.resource.events.RENDER_TRANSFORM_CHANGED,this.s2pRenderTransformChangedListener,this);for(var n=this.s2p.layersToArray(),a=0;a<n.length;++a)this.s2pAddLayer(n[a]);this.s2pStreamSizeChangedListener()},VideoJSDelegate.prototype.getVideoElement=function(){return this.videoElement},VideoJSDelegate.prototype.getMediaURL=function(){if("function"==typeof this.video.currentSources)for(var e=this.video.currentSources(),t=0;t<e.length;t++)if("video/mp4"===e[t].type)return e[t].src;return null},VideoJSDelegate.prototype.destroy=function(){this.s2p.removeEventListener(adways.resource.events.PLAY_STATE_CHANGED,this.s2pPlayStateChangedListener,this),this.s2p.removeEventListener(adways.resource.events.VOLUME_CHANGED,this.s2pVolumeChangedListener,this),this.s2p.removeEventListener(adways.resource.events.MUTED_CHANGED,this.s2pMutedChangedListener,this),this.s2p.removeEventListener(adways.resource.events.CURRENT_TIME_CHANGED,this.s2pCurrentTimeChangedListener,this),this.s2p.removeEventListener(adways.resource.events.PLAYBACK_RATE_CHANGED,this.s2pPlaybackRateChangedListener,this),this.s2p.removeEventListener(adways.resource.events.FULLSCREEN_CHANGED,this.s2pFullscreenChangedListener,this),this.s2p.removeEventListener(adways.hv.events.LAYER_ADDED,this.s2pLayerAddedListener,this),this.s2p.removeEventListener(adways.hv.events.LAYER_REMOVED,this.s2pLayerRemovedListener,this),this.s2p.removeEventListener(adways.resource.events.STREAM_SIZE_CHANGED,this.s2pStreamSizeChangedListener,this),this.s2p.removeEventListener(adways.resource.events.RENDER_SIZE_CHANGED,this.s2pRenderSizeChangedListener,this),this.s2p.removeEventListener(adways.resource.events.RENDER_TRANSFORM_CHANGED,this.s2pRenderTransformChangedListener,this),this.video.off("durationchange",this.videoDurationListener),this.video.off("timeupdate",this.videoTimeUpdateListener),this.video.off("play",this.videoPlayStateListener),this.video.off("pause",this.videoPlayStateListener),this.video.off("ended",this.videoEndedListener),this.video.off("seeking",this.videoSeekingListener),this.video.off("seeked",this.videoSeekedListener),this.video.off("volumechange",this.videoVolumeListener),this.video.off("error",this.videoErrorListener),clearInterval(this.sizeWatcherTimer),this.video.off("fullscreenchange",this.videoFullscreenListener),this.video.off("loadedmetadata",this.videoLoadedMetaDataListener),this.isIOS&&(adways.fullscreenManager.removeEventListener(adways.misc.html.fullscreen.events.ENTERED,this.fullscreenEnteredCB,this),adways.fullscreenManager.removeEventListener(adways.misc.html.fullscreen.events.EXITED,this.fullscreenExitedCB,this),adways.misc.html.removeEventListener(this.fullscreenButton,"touchstart",this.fullscreenCB,!0)),99==this.videoElement.style.zIndex&&(this.videoElement.style.removeProperty("z-index"),this.interactiveContainer[0].style.setProperty("width","100%"),this.interactiveContainer[0].style.setProperty("height","100%"),this.interactiveContainer[0].style.removeProperty("position"))},VideoJSDelegate.prototype.s2pPlayStateChangedListener=function(){switch(this.s2p.getPlayState().valueOf()){case adways.resource.playStates.PLAYING:this.video.play();break;case adways.resource.playStates.PAUSED:this.video.pause()}},VideoJSDelegate.prototype.s2pVolumeChangedListener=function(){isNaN(this.s2p.getVolume().valueOf())||this.video.volume(this.s2p.getVolume().valueOf())},VideoJSDelegate.prototype.s2pMutedChangedListener=function(){this.video.muted(this.s2p.getMuted().valueOf())},VideoJSDelegate.prototype.s2pCurrentTimeChangedListener=function(){isNaN(this.s2p.getCurrentTime().valueOf())||this.video.currentTime(this.s2p.getCurrentTime().valueOf())},VideoJSDelegate.prototype.s2pPlaybackRateChangedListener=function(){},VideoJSDelegate.prototype.s2pFullscreenChangedListener=function(){this.isIOS?this.s2p.getFullscreen().valueOf()?this.customFullscreen.enterFullscreen():adways.fullscreenManager.exitFullscreen():this.s2p.getFullscreen().valueOf()?this.video.requestFullscreen():this.video.exitFullscreen()},VideoJSDelegate.prototype.s2pLayerAddedListener=function(e){this.s2pAddLayer(e.getLayer())},VideoJSDelegate.prototype.s2pAddLayer=function(e){var t=document.getElementsByClassName("upvideo__interactive-container"),s=e.getDomElement();s.style.position="absolute";var i=0,r=0;if(this.playerSizeIncludesControllerSize&&!this.video.isFullscreen()){var n=this.video.controlBar.el(),a=this.evaluateControlBarPosition();4==a&&(r+=n.offsetLeft),1==a&&(i+=n.offsetTop)}if(s.style.top=i+"px",s.style.left=r+"px",e.getLayerId()==adways.hv.layerIds.TOP)this.topDiv=s,this.topDiv.className="adways-top-layer",this.topDiv.style.zIndex=this.zIndexLayers+99,this.video.el().appendChild(s);else if(e.getLayerId()==adways.hv.layerIds.BACKGROUND)this.backgroundDiv=s,this.backgroundDiv.className="adways-background-layer",t.length>0&&(s.style.zIndex=99,this.videoElement.style.zIndex=99,t[0].style.zIndex=99),null!=this.videoElement?this.video.el().insertBefore(s,this.videoElement):this.video.el().appendChild(s);else if(e.getLayerId()==adways.hv.layerIds.HOTSPOT)this.hotspotDiv=s,s.className="adways-hotspot-layer",t.length>0&&(s.style.zIndex=99),this.video.el().insertBefore(s,this.video.controlBar.el());else if(e.getLayerId()==adways.hv.layerIds.POPUP)this.popupDiv=s,s.className="adways-popup-layer",s.style.zIndex=this.zIndexLayers+2,this.video.el().appendChild(s);else if(e.getLayerId()==adways.hv.layerIds.CONTROLLER){this.controllerDiv=s,s.className="adways-controller-layer";var o=this.video.el().getElementsByClassName("adways-popup-layer");o.length>0?(this.video.el().insertBefore(s,o[0]),s.style.zIndex=this.zIndexLayers+1):this.video.controlBar.el().parentNode.insertBefore(s,this.video.controlBar.el().nextSibling)}},VideoJSDelegate.prototype.s2pLayerRemovedListener=function(e){var t=e.getLayer(),s=t.getDomElement();switch(this.video.el().removeChild(s),t.getLayerId()){case adways.hv.layerIds.BACKGROUND:this.backgroundDiv=null;break;case adways.hv.layerIds.HOTSPOT:this.hotspotDiv=null;break;case adways.hv.layerIds.POPUP:this.popupDiv=null;break;case adways.hv.layerIds.CONTROLLER:this.controllerDiv=null;break;case adways.hv.layerIds.TOP:this.topDiv=null}},VideoJSDelegate.prototype.s2pStreamSizeChangedListener=function(e){if(isNaN(this.streamWidth)||isNaN(this.streamHeight)){var t=this.s2p.getStreamSize();t[0]===this.streamWidth&&t[1]===this.streamHeight||null!=this.videoElement||(this.streamWidth=t[0],this.streamHeight=t[1],this.updateStreamRect())}},VideoJSDelegate.prototype.s2pRenderSizeChangedListener=function(e){var t=this.s2p.getRenderSize();this.videoElement.style.setProperty("width",100*t[0]/this.video.el().offsetWidth+"%","important"),this.videoElement.style.setProperty("height",100*t[1]/this.video.el().offsetHeight+"%","important"),this.interactiveContainer.length>0&&(this.interactiveContainer[0].style.setProperty("width",100*t[0]/this.video.el().offsetWidth+"%","important"),this.interactiveContainer[0].style.setProperty("height",100*t[1]/this.video.el().offsetHeight+"%","important"),this.interactiveContainer[0].style.setProperty("position","relative","important"))},VideoJSDelegate.prototype.s2pRenderTransformChangedListener=function(e){var t=this.s2p.getRenderTransform(),s=adways.misc.html.gtToCSSMatrix(t);this.videoElement.style.transform=s,this.videoElement.style.transformOrigin="top left",this.videoElement.style.msTransform=s,this.videoElement.style.msTransformOrigin="top left",this.isIOS&&this.nativeControls&&this.fullscreenButton&&(this.fullscreenButton.style.left=t[4]+"px",this.fullscreenButton.style.top=t[5]+"px")},VideoJSDelegate.prototype.evaluateControlBarPosition=function(){var e=this.video.controlBar.el(),t=this.video.el();return e.offsetParent===t?e.offsetTop<0?1:e.offsetLeft<0?4:e.offsetTop+e.offsetHeight>t.offsetHeight?3:e.offsetLeft+e.offsetWidth>t.offsetWidth?2:0:0},VideoJSDelegate.prototype.updateRenderRect=function(){var e=0,t=new Array(this.videoElement.offsetWidth,this.videoElement.offsetHeight);this.renderSize[0]===t[0]&&this.renderSize[1]===t[1]||(e+=this.p2s.setRenderSize(t),this.renderSize=t);var s=adways.misc.html.getCssTransformGTA(this.videoElement);return this.renderTransform.join(",")!==s.join(",")&&(e+=this.p2s.setRenderTransform(s),this.renderTransform=s),e},VideoJSDelegate.prototype.updateStreamRect=function(){if(isNaN(this.streamWidth)||isNaN(this.streamHeight)||isNaN(this.videoElement.offsetWidth)||isNaN(this.videoElement.offsetHeight))isNaN(this.streamWidth)||isNaN(this.streamHeight)?(console.warn("VideoJS is not able to determine the native stream size, positions and sizes may be wrong"),this.p2s.setStreamSize(new Array(this.videoElement.offsetWidth,this.videoElement.offsetHeight))):(console.warn("VideoJS is not able to determine the container size, positions and sizes may be wrong"),this.p2s.setStreamSize(new Array(this.streamWidth,this.streamHeight))),this.p2s.setStreamTransform(new Array(1,0,0,1,0,0));else{var e=new Array(this.streamWidth,this.streamHeight),t=adways.geom.evaluateContentRect(e,new Array(this.videoElement.offsetWidth,this.videoElement.offsetHeight));if(this.p2s.setStreamSize(new Array(t[2],t[3])),this.playerSizeIncludesControllerSize&&!this.video.isFullscreen()){var s=this.video.controlBar.el(),i=this.evaluateControlBarPosition();4==i&&(t[0]-=s.offsetLeft),1==i&&(t[1]-=s.offsetTop)}this.p2s.setStreamTransform(new Array(1,0,0,1,t[0],t[1]))}};